# 브라우저의 동작 원리

## 브라우저의 주요 기능

- 사용자가 선택한 **자원을 서버에 요청**한다. 자원은 보통 HTML 문서지만 PDF나 이미지 또는 다른 형태일 수 있다. 자원의 주소는 URI(Uniform Resource Identifier)에 의해 정해진다.
- HTML과 CSS 명세에 따라 HTML 파일을 해석해서 표시한다.

</br>

## 브라우저의 기본 구조

<img src="https://d2.naver.com/content/images/2015/06/helloworld-59361-1.png">

1. **사용자 인터페이스**
   </br>
   주소 표시줄, 이전/다음 버튼, 북마크 메뉴 등. 요청한 페이지를 보여주는 창을 제외한 나머지 모든 부분

2. **브라우저 엔진**
   </br>
   사용자 인터페이스와 렌더링 엔진 사이의 동작을 제어

3. **렌더링 엔진**
   </br>
   요청한 콘텐츠를 표시. 예를 들어 HTML을 요청하면 HTML과 CSS를 파싱하여 화면에 표시

4. **통신**
   </br>
   HTTP 요청과 같은 네트워크 호출에 사용됨. 이것은 플랫폼 독립적인 인터페이스이고 각 플랫폼 하부에서 실행

5. **UI 백엔드**
   </br>
   콤보 박스(셀렉트 박스)와 창 같은 기본적인 장치를 그림. 플랫폼에서 명시하지 않은 일반적인 인터페이스로서, OS 사용자 인터페이스 체계를 사용

6. **자바스크립트 해석기**
   </br>
   자바스크립트 코드를 해석하고 실행

7. **자료 저장소**
   </br>
   자료를 저장하는 계층

</br>

## 렌더링 엔진

렌더링 엔진은 HTML 및 XML 문서와 이미지를 표시할 수 있다. 추가로 플러그인이나 브라우저 확장 기능을 이용해 PDF와 같은 다른 유형도 표시할 수 있다.

</br>

**렌더링 엔진 종류**

- 웹킷(Webkit) 엔진 : 크롬, 사파리
- 게코(Gecko) 엔진 : 파이어폭스

</br>

**렌더링 동작 과정**
</br>
<img src="https://d2.naver.com/content/images/2015/06/helloworld-59361-2.png">

1. HTML 문서를 파싱한다.
2. "콘텐츠 트리" 내부에서 태그를 `DOM` 노드로 변환한다.
3. 외부 CSS 파일과 함께 포함된 스타일 요소를 파싱한다.
4. `CSSOM`를 만든다.
5. 스타일 정보(CSSOM)와 HTML 표시 규칙(DOM)은 `Render Tree`라는 또 다른 트리를 생성한다.
6. `Layout` - 렌더 트리 생성이 끝난 후, 배치를 시작한다.
   </br>
   (각 노드가 화면의 정확한 위치에 표시되는 것을 의미)
7. `Paint` UI 백엔드에서 렌더 트리의 각 노드를 가로지으며 형상을 만드는 그리기 과정을 진행한다.
   </br>
   (좀 더 나은 사용자 경험을 위해 모든 HTML을 파싱할 때까지 기다리지 않고 배치와 그리기 과정을 시작)
8. 전송을 받고 기다리는 동시에 받은 내용을 먼저 화면에 보여준다.

</br>

**DOM** </br> 문서 객체 모델 (Document Object Model, DOM)은 HTML, XML 문서를 구조화된 표현(트리 구조)으로 나타냄으로써 프로그래밍 언어가 DOM 구조에 접근할 수 있는 방법을 제공하여 문서 구조, 스타일, 내용 등을 변경할 수 있게 돕는다.
</br> 즉, DOM은 웹 페이지의 `객체 지향 표현`이며, 자바스크립트와 같은 스크립팅 언어를 이용해 DOM을 수정할 수 있다.

</br>

**파싱(Parsing)**
</br>
브라우저가 코드를 이해하고 사용할 수 있는 구조로 변환하는 과정
</br>

> 브라우저는 HTML, CSS 문서를 파싱하여 트리를 만든다.</br> > `HTML -> DOM`</br> > `CSS -> CSSOM` </br>

- 어휘 분석 : 자료를 토큰으로 분해하는 과정
- 구문 분석 : 언어의 구문 규칙을 적용하는 과정
